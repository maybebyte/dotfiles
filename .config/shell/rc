# These are features that are specific to pdksh.
case "${KSH_VERSION%%\ KSH*}" in
	'@(#)PD')
		# Prefix characters with the eighth bit set with 'M-', rather
		# than printing them as is (it may cause problems otherwise).
		set -o vi-show8
esac

# Enable ^T binding as a quick way to send SIGINFO. Useful for
# retrieving dd(1) updates on *BSD, for instance. Note that SIGINFO is
# only supported on *BSD, so that's the reason for the check.
#
# This stty command may work on a *BSD other than OpenBSD, but I haven't
# personally tested it. So I'm keeping this to what I've tested.
if [ "$(uname)" = 'OpenBSD' ]; then
	stty status "^T"
fi

set -o vi

GPG_TTY="$(tty)"
export GPG_TTY

. "${XDG_CONFIG_HOME}/shell/aliases"
. "${XDG_CONFIG_HOME}/shell/functions"
. "${XDG_CONFIG_HOME}/shell/prompt"

# Automatically launch sway if:
# 1) Wayland is not running
# 2) We've logged into the first virtual terminal
# 3) We're using Linux
if [ -z "${WAYLAND_DISPLAY}" ] && [ "${XDG_VTNR}" -eq 1 ] && [ "$(uname)" = "Linux" ]; then
	exec dbus-run-session sway
fi

# If tmux is installed and not inside a tmux session, then try to attach.
# If attachment fails, start a new session.
if [ -z "${TMUX}" ] && command -v tmux > /dev/null 2>&1; then
		{ tmux attach || tmux; } > /dev/null 2>&1
fi
